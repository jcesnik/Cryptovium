////////////////////////////////////////////////////////////////////////////////
// Copyright (C) 2017 Lightfactor, LLC. All rights reserved.
//
// Author:			Jeff Cesnik <jcesnik@lightfactor.co>
// Last Modified:	01/13/2017
//
////////////////////////////////////////////////////////////////////////////////


#include "zeroize.h"
#include <stdint.h>


////////////////////////////////////////////////////////////////////////////////
void zeroize(void *v, uint32_t n)
{
	// this should not get optimized away by the compiler
	volatile uint8_t*	p;
	
	p = v;
	while (n--) { *p++ = 0; }
}

////////////////////////////////////////////////////////////////////////////////
void zeroize_stack(void)
{
	uint8_t		z[ZEROIZE_STACK_SIZE];

	zeroize(z, ZEROIZE_STACK_SIZE);
}
